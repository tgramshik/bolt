# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Bot –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π —á–µ—Ä–µ–∑ Stars

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

‚úÖ **Telegram WebApp SDK** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API Telegram –¥–ª—è –º–∏–Ω–∏–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
‚úÖ **–°–∏—Å—Ç–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π** - –∑–∞–ø—Ä–æ—Å –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ Telegram Stars  
‚úÖ **UI/UX –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π** - –∫–Ω–æ–ø–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–û–ø–ª–∞—Ç–∏—Ç—å –¥–æ—Å—Ç—É–ø (100 ‚≠ê)" –∫–æ–≥–¥–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞
‚úÖ **Haptic Feedback** - —Ç–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –¥–ª—è –ª—É—á—à–µ–≥–æ UX
‚úÖ **–°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç—É–ø–∞** - –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ü—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø"

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü–µ—Ä–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É "–û–ø–ª–∞—Ç–∏—Ç—å –¥–æ—Å—Ç—É–ø (100 ‚≠ê)"
2. **–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã
3. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –±–æ—Ç—É —á–µ—Ä–µ–∑ `tg.sendData()`
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ—Ç–æ–º**: –ë–æ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞—Ç—å –∏–Ω–≤–æ–π—Å –¥–ª—è Telegram Stars
5. **–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç WebApp

```python
# –í –≤–∞—à–µ–º Telegram –±–æ—Ç–µ
import json
from telegram import Update, LabeledPrice
from telegram.ext import ContextTypes

async def handle_web_app_data(update: Update, context: ContextTypes.DEFAULT_TYPE):
    web_app_data = update.message.web_app_data.data
    data = json.loads(web_app_data)
    
    if data.get('action') == 'request_payment':
        # –°–æ–∑–¥–∞–µ–º –∏–Ω–≤–æ–π—Å –¥–ª—è Telegram Stars
        await create_stars_invoice(update, context, data)

async def create_stars_invoice(update: Update, context: ContextTypes.DEFAULT_TYPE, data):
    prices = [LabeledPrice("–ú–µ—Å—è—á–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞", data['amount'])]
    
    await context.bot.send_invoice(
        chat_id=update.effective_chat.id,
        title="–ê–Ω–æ—Ä–∞ –ê—Ä—Ç - –ü—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø",
        description=data['description'],
        payload="monthly_subscription",
        provider_token="",  # –ü—É—Å—Ç–æ–π –¥–ª—è Telegram Stars
        currency="XTR",  # Telegram Stars
        prices=prices,
        start_parameter="subscription"
    )
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã

```python
async def successful_payment(update: Update, context: ContextTypes.DEFAULT_TYPE):
    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ–ø–ª–∞—Ç–∏–ª
    user_id = update.effective_user.id
    
    # –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥–ø–∏—Å–∫–µ –≤ –≤–∞—à–µ–π –ë–î
    # –ù–∞–ø—Ä–∏–º–µ—Ä: save_subscription(user_id, expires_at=datetime.now() + timedelta(days=30))
    
    await update.message.reply_text(
        "üéâ –°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –º–µ—Å—è—Ü."
    )
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞

–î–æ–±–∞–≤—å—Ç–µ –≤ WebApp –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏:

```javascript
// –í useTelegram.ts –¥–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞
const checkAccess = async () => {
  if (!tg) return false;
  
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –±–æ—Ç—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏
  const checkData = {
    action: 'check_subscription',
    user_id: user?.id
  };
  
  tg.sendData(JSON.stringify(checkData));
  
  // –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å —á–µ—Ä–µ–∑ postMessage –∏–ª–∏ –¥—Ä—É–≥–∏–º —Å–ø–æ—Å–æ–±–æ–º
};
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ types/telegram.ts          # TypeScript —Ç–∏–ø—ã –¥–ª—è Telegram WebApp API
‚îú‚îÄ‚îÄ hooks/useTelegram.ts       # React —Ö—É–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram
‚îî‚îÄ‚îÄ App.tsx                    # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –ø–ª–∞—Ç–µ–∂–µ–π
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–í –±—Ä–∞—É–∑–µ—Ä–µ**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ `window.Telegram` –±—É–¥–µ—Ç undefined
2. **–í Telegram**: –û—Ç–∫—Ä–æ–π—Ç–µ WebApp —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–≠–º—É–ª—è—Ü–∏—è**: –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏** - –¥–æ–±–∞–≤—å—Ç–µ —Ç–∞–π–º–µ—Ä –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- **–†–∞–∑–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã** - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ –ø–æ–¥–ø–∏—Å–∫–∏  
- **–ü—Ä–æ–º–æ–∫–æ–¥—ã** - —Å–∏—Å—Ç–µ–º–∞ —Å–∫–∏–¥–æ–∫ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- **–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π** - –ø–æ–∫–∞–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –±–æ—Ç–∞, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ WebApp, —Ç–∞–∫ –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
